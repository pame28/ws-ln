// ðŸ”¹ INICIO CAMBIO: Validaciones de campos de entrada segÃºn tipo de persona

// Validaciones globales
if (string.IsNullOrWhiteSpace(tramaIdentidad))
{
    dtErrores.Rows.Add(1);
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E001";
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Identidad' no puede estar vacÃ­o.";
}

if (string.IsNullOrWhiteSpace(tramaNacionalidad))
{
    dtErrores.Rows.Add(1);
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E002";
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Nacionalidad' no puede estar vacÃ­o.";
}

if (string.IsNullOrWhiteSpace(tramaFechaNacimiento))
{
    dtErrores.Rows.Add(1);
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E003";
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Fecha de Nacimiento' no puede estar vacÃ­o.";
}

if (string.IsNullOrWhiteSpace(tramaGrupoLista))
{
    dtErrores.Rows.Add(1);
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E004";
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Grupo Lista' no puede estar vacÃ­o.";
}


// Validaciones especÃ­ficas por tipo de persona
if (tramaTipoPersona.ToUpper() == "N")
{
    if (string.IsNullOrWhiteSpace(tramaPrimerNombre))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E005";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Primer Nombre' es obligatorio para personas naturales.";
    }

    if (string.IsNullOrWhiteSpace(tramaSegundoNombre))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E006";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Segundo Nombre' es obligatorio para personas naturales.";
    }

    if (string.IsNullOrWhiteSpace(tramaPrimerApellido))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E007";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Primer Apellido' es obligatorio para personas naturales.";
    }

    if (string.IsNullOrWhiteSpace(tramaSegundoApellido))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E008";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Segundo Apellido' es obligatorio para personas naturales.";
    }
}
else if (tramaTipoPersona.ToUpper() == "J")
{
    if (!string.IsNullOrWhiteSpace(tramaPrimerNombre))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E009";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Primer Nombre' debe estar vacÃ­o para personas jurÃ­dicas.";
    }

    if (!string.IsNullOrWhiteSpace(tramaSegundoNombre))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E010";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Segundo Nombre' debe estar vacÃ­o para personas jurÃ­dicas.";
    }

    if (!string.IsNullOrWhiteSpace(tramaPrimerApellido))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E011";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Primer Apellido' debe estar vacÃ­o para personas jurÃ­dicas.";
    }

    if (!string.IsNullOrWhiteSpace(tramaSegundoApellido))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E012";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Segundo Apellido' debe estar vacÃ­o para personas jurÃ­dicas.";
    }

    if (string.IsNullOrWhiteSpace(tramaRazonSocial))
    {
        dtErrores.Rows.Add(1);
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E013";
        dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'RazÃ³n Social' es obligatorio para personas jurÃ­dicas.";
    }
}
else
{
    dtErrores.Rows.Add(1);
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Codigo"] = "E014";
    dtErrores.Rows[dtErrores.Rows.Count - 1]["Descripcion"] = "El campo 'Tipo de Persona' debe ser 'N' (Natural) o 'J' (JurÃ­dica).";
}

// Si hubo errores, devolverlos inmediatamente antes de continuar
if (dtErrores.Rows.Count > 0)
{
    return dtErrores;
}

// ðŸ”¹ FIN CAMBIO
